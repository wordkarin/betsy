<article>
  <header>
    <h1 class="page-title">This is the show page for order <%= @order.name%></h1>
  </header>

<p><%= link_to "Edit Order", edit_order_path(params[:id]) %></p>

<section>
  <p></p>
  <table style="width:100%">
    <h3>Customer Information:</h3>
  <tr>
    <th>Email:</th>
    <td><%= @order.email %></td>
  </tr>
  <tr>
    <th>Mailing Address:</th>
    <td><%= @order.mailing_address %></td>
  </tr>
  <tr>
    <th>Name on Credit Card:</th>
    <td><%= @order.name %></td>
  </tr>
  <tr>
    <th>Last four digits of Credit Card:</th>
    <!-- Will have to adjust the order model - to include leading zeros -->
    <td><%= sprintf '%04d' % @order.cc_last_4 %></td>
  </tr>
  <tr>
    <th>Credit Card Expiration Date:</th>
    <!-- Currently not displaying the expiration date.  -->
    <td><%= @order.cc_expire %></td>
  </tr>
</table>
</section>



<section>
  <table>
    <h3>Order Information:</h3>
    <tr>
      <th>Product Item</th>
      <th>Quantity</th>
      <th>Price per Item</th>
      <th>Total Purchase Price</th>
      <th>Shipped?</th>
    </tr>
    <% @order_items.each do |item| %>
    <tr>
        <td><%= Product.find(item.product_id).name%></td>
        <td><%= item.quantity%></td>
        <td><%= Product.find(item.product_id).price%></td>
        <td><%= Product.find(item.product_id).price * item.quantity%></td>
        <td>
          <%= item.shipping_status%>
          <% if session[:user_id] == Product.find(item.product_id).merchant_id %>
          <%= button_to "ship this product", some_path %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </table>
</section>


<% @order_items.each do |item| %>
  <% if @order.id == item.order_id %>
    <p> Merchant_id: <%=(item.product.merchant_id) %>Product_id: <%= item.product_id %> Order_id <%= item.order_id %></p>
  <% end %>
<% end %>

<!-- this link to edit order will be restricted to customer if order_status is pending) -->
  <p><%= link_to "Edit Order", edit_order_path(params[:id]) %></p>
</article>
